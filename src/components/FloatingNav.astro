---
interface NavItem {
  id: string;
  label: string;
}

const navItems: NavItem[] = [
  { id: "top", label: "Top" }, 
  { id: "treatment", label: "Treatment" },
  { id: "tech", label: "Technology" },
  { id: "testimonials", label: "Testimonials" },
  { id: "unique", label: "Our Approach" },
  { id: "therapists", label: "Specialists" },
  { id: "location", label: "Locations" },
  { id: "contact", label: "Contact" },
];
---

<!-- Floating Navigation Dots (Desktop Only) -->
<nav id="floating-nav" class="hidden lg:block fixed right-8 top-1/2 -translate-y-1/2 z-50">
  <ul class="space-y-4">
    {navItems.map((item, index) => (
      <li class="group relative">
        <a 
          href={`#${item.id}`}
          data-nav-dot
          data-target={item.id}
          class="nav-dot block w-3 h-3 rounded-full bg-blue-200 border-2 border-blue-400 backdrop-blur-sm transition-all duration-300 hover:bg-blue-500 hover:border-blue-600 hover:scale-150 hover:shadow-lg hover:shadow-blue-500/50"
          aria-label={`Navigate to ${item.label}`}
        >
        </a>
        
        <!-- Tooltip on hover -->
        <span class="nav-tooltip absolute right-6 top-1/2 -translate-y-1/2 px-3 py-1.5 bg-blue-600 backdrop-blur-md border border-blue-500 rounded-lg text-white text-sm font-semibold whitespace-nowrap opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 pointer-events-none shadow-lg">
          {item.label}
        </span>
      </li>
    ))}
  </ul>
</nav>

<!-- Smooth Scroll & Active State Script -->
<script>
  document.addEventListener('DOMContentLoaded', () => {
    const navDots = document.querySelectorAll('[data-nav-dot]');
    const sections = document.querySelectorAll('section, div[id]');
    
    // Smooth scroll to section or top
    navDots.forEach(dot => {
      dot.addEventListener('click', (e) => {
        e.preventDefault();
        const targetId = dot.getAttribute('data-target');
        
        // Special handler for "top" - scroll to very top of page
        if (targetId === 'top') {
          window.scrollTo({ 
            top: 0, 
            behavior: 'smooth' 
          });
        } else {
          const targetSection = document.getElementById(targetId);
          
          if (targetSection) {
            targetSection.scrollIntoView({ 
              behavior: 'smooth', 
              block: 'start' 
            });
          }
        }
      });
    });
    
    // Update active dot on scroll
    const updateActiveDot = () => {
      const scrollPosition = window.scrollY + 200;
      
      // Special handling: if at top of page, activate "top" dot
      if (window.scrollY < 100) {
        navDots.forEach(dot => {
          dot.classList.remove('active-dot', 'bg-blue-500', 'border-blue-600', 'scale-150', 'shadow-lg', 'shadow-blue-500/50');
          dot.classList.add('bg-blue-200', 'border-blue-400');
        });
        
        const topDot = document.querySelector('[data-target="top"]');
        if (topDot) {
          topDot.classList.add('active-dot');
          topDot.classList.remove('bg-blue-200', 'border-blue-400');
          topDot.classList.add('bg-blue-500', 'border-blue-600', 'scale-150', 'shadow-lg', 'shadow-blue-500/50');
        }
        return;
      }
      
      sections.forEach(section => {
        const sectionTop = section.offsetTop;
        const sectionHeight = section.offsetHeight;
        const sectionId = section.getAttribute('id');
        
        if (scrollPosition >= sectionTop && scrollPosition < sectionTop + sectionHeight) {
          // Remove active class from all dots
          navDots.forEach(dot => {
            dot.classList.remove('active-dot');
            dot.classList.remove('bg-blue-500', 'border-blue-600', 'scale-150', 'shadow-lg', 'shadow-blue-500/50');
            dot.classList.add('bg-blue-200', 'border-blue-400');
          });
          
          // Add active class to current dot
          const activeDot = document.querySelector(`[data-target="${sectionId}"]`);
          if (activeDot) {
            activeDot.classList.add('active-dot');
            activeDot.classList.remove('bg-blue-200', 'border-blue-400');
            activeDot.classList.add('bg-blue-500', 'border-blue-600', 'scale-150', 'shadow-lg', 'shadow-blue-500/50');
          }
        }
      });
    };
    
    // Throttled scroll listener for performance
    let ticking = false;
    window.addEventListener('scroll', () => {
      if (!ticking) {
        window.requestAnimationFrame(() => {
          updateActiveDot();
          ticking = false;
        });
        ticking = true;
      }
    });
    
    // Initial check
    updateActiveDot();
  });
</script>

<style>
  /* Glassmorphism effect for navigation */
  #floating-nav {
    backdrop-filter: blur(10px);
  }
  
  /* Active dot styling */
  .active-dot {
    transform: scale(1.5) !important;
  }
  
  /* Smooth tooltip animation */
  .nav-tooltip {
    box-shadow: 0 4px 12px rgba(37, 99, 235, 0.4);
  }
  
  /* Fade in animation on load */
  #floating-nav {
    animation: fadeInRight 0.5s ease-out 0.3s both;
  }
  
  @keyframes fadeInRight {
    from {
      opacity: 0;
      transform: translateY(-50%) translateX(20px);
    }
    to {
      opacity: 1;
      transform: translateY(-50%) translateX(0);
    }
  }

  /* Ensure dots are always visible */
  .nav-dot {
    box-shadow: 0 2px 8px rgba(59, 130, 246, 0.3);
  }

  .nav-dot:hover {
    box-shadow: 0 4px 16px rgba(59, 130, 246, 0.6);
  }
</style>
